<div class="holder">
  <div class="robo-background">
  </div>
  <div class="card-holder">
    <div class="container">
      <div class="d-flex justify-content-between">
        <div class="col-4">
          <div class="profile-image">
            <div class="profile-avatar">
              <% if @user.photos.present? %>
                <%= cl_image_tag @user.photos.key, height: 150, width: 150, crop: :fill %>
              <% else %>
                <% img_source = "https://robohash.org/#{rand(1..99)}" %>
                <%= image_tag(img_source, :alt => "robot alter-ego") %>
                <%= link_to "Add and pic of you", edit_user_registration_path %>
              <% end %>
            </div>
          </div>
          
          <% if @user.username.present? %>
            <h1><%= @user.username %></h1>
          <% else %>
            <h1><%= @user.first_name %> <%= @user.last_name %></h1>
          <% end %>

          <h2>Name</h2>
          <div class="full-name">
            <% if @user.first_name.present?  %>
              <p><%= @user.first_name %></p>
            <% else %>
              <p><%= link_to "Add first name", edit_user_registration_path %></p>
            <% end %>
            <% if @user.last_name.present?  %>
              <p><%= @user.last_name %></p>
            <% else %>
              <p><%= link_to "Add last name", edit_user_registration_path %></p>
            <% end %>
          </div>
          <p><%= link_to "Edit my profile", edit_user_registration_path %></p>
        </div>

        <div class="col-8">
          <% if @user.appointments.length == 0 %>
            <div class="profile-titles">
              <div class="d-flex justify-content-left">
                <h2>Appointments</h2>
              </div>
              <p>No appointments currently booked - <%= link_to "book one now.", robots_path %></p>
            </div>
          <% else %>
            <p><%= link_to "Add another appointment", robots_path %></p>
            <ul>        
              <% @user.appointments.each do |app| %>
                <li><%= app.robot %> booked for <%= app.sessions_durations %> at <%= app.sessions_datetime %></li>
              <% end %>        
            </ul>
          <% end %>

          <% if @user.robots.length == 0 %>
            <div class="profile-titles">
              <div class="d-flex justify-content-between">
                <h3>Robots</h3>
                <p>No robots currently added - <%= link_to "add one now.", new_robot_path %></p>
              </div>
            </div>
          <% else %>
            <div class="profile-titles">
              <div class="d-flex justify-content-between">
                <h2>Robots</h2>
                <p><%= link_to "Add another robot", new_robot_path %></p>
              </div>
            </div>           
            <% @user.robots.each do |robot| %>
              <div class="card">
                <div>
                  <%= image_tag "bot", alt: "robot pic" %>
                </div>
                <div class="card-info">
                  <h3><%=robot.name%></h3>
                  <p>Rating: <%=robot.rating %></p>
                </div>
                <div class="card-details">
                <p>Function: <%=robot.function %></p>
                </div>
                <div class="pay-btn">
                <a class="btn btn-ghost" href="#">BOOK</a>
                </div>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
